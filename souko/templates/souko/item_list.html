{% extends "souko/base.html" %}

{% block content %}
  {% block heading %}{% endblock heading %}

  {% if page_obj.paginator.count > 0 %}
    <div class="top-page-selector-container">
      <div class="top-page-selector mb-4">
        {% if page_obj.has_previous %}
          <a class="btn btn-outline-orange" href="?page=1">&#x21E4</a>
          <a class="btn btn-outline-orange" href="?page={{ page_obj.previous_page_number }}">&#x2190</a>
        {% endif %}

        {% for num in page_obj.paginator.page_range %}
          {% if page_obj.number == num %}
            <a class="btn btn-orange" href="?page={{ num }}">{{ num }}</a>
          {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
            <a class="btn btn-outline-orange" href="?page={{ num }}">{{ num }}</a>
          {% endif %}
        {% endfor %}

        {% if page_obj.has_next %}
          <a class="btn btn-outline-orange" href="?page={{ page_obj.next_page_number }}">&#x2192</a>
          <a class="btn btn-outline-orange" href="?page={{ page_obj.paginator.num_pages }}">&#x21E5</a>
        {% endif %}
      </div>
    </div>
  {% endif %}

  <div class="mb-4">
    {% block list_submenu %}{% endblock list_submenu %}
    {% if user.username == view.kwargs.username %}
      <a href="{% url 'item-create' %}" class="btn btn-primary add-item"><i class="fas fa-plus mr-2"></i>Add Item</a>
    {% endif %}
  </div>

  {% for item in items %}
  <article class="media content-section">
    <img class="cover-art" src="{{ item.cover_art.url }}" alt="cover_art">
    <div class="media-body">
      <div class="content-title">
        <h2 class="pl-2">{{ item.title }}</h2>
      </div>
      <div class="content-data pl-2 pt-3">
        <p>
          <span class="data-title">Series:</span>
          {{ item.series }}
        </p>
        <p>
          <span class="data-title">Genre:</span>
          {{ item.get_genre_display }}
        </p>
        <p>
          <span class="data-title">Status:</span>
          {% if item.completed %}
            {% if user == item.user %}
              <span class="status-toggle content-completed" onclick="toggleCompleted(this)" data-pk="{{ item.pk }}">Completed</span>
            {% else %}
              <span class="content-completed">Completed</span>
            {% endif %}
          {% else %}
            {% if user == item.user %}
              <span class="status-toggle content-inprogress" onclick="toggleCompleted(this)" data-pk="{{ item.pk }}">In Progress</span>
            {% else %}
              <span class="content-inprogress">In Progress</span>
            {% endif %}
          {% endif %}
        </p>
        <p>
          <span class="data-title">Date Started:</span>
          <span>{{ item.date_started|date:"Y/m/d" }}</span>
        </p>
        <p>
          <span class="data-title">Date Completed:</span>
          <span id="date_completed{{ item.pk }}">{{ item.date_completed|date:"Y/m/d" }}</span>
          {% if user == item.user %}
            <a href="{% url 'item-delete' item.pk %}" class="btn btn-danger content-button"><i class="fas fa-trash-alt mr-2"></i>Delete</a>
            <a href="{% url 'item-update' item.pk %}" class="btn btn-info content-button"><i class="fas fa-pencil-alt mr-2"></i>Edit</a>
          {% endif %}
        </p>
      </div>
    </div>
  </article>
  {% endfor %}

  {% if page_obj.paginator.count > 0 %}
    <div class="bottom-page-selector">
      {% if page_obj.has_previous %}
        <a class="btn btn-outline-orange" href="?page=1">&#x21E4</a>
        <a class="btn btn-outline-orange" href="?page={{ page_obj.previous_page_number }}">&#x2190</a>
      {% endif %}

      {% for num in page_obj.paginator.page_range %}
        {% if page_obj.number == num %}
          <a class="btn btn-orange" href="?page={{ num }}">{{ num }}</a>
        {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
          <a class="btn btn-outline-orange" href="?page={{ num }}">{{ num }}</a>
        {% endif %}
      {% endfor %}

      {% if page_obj.has_next %}
        <a class="btn btn-outline-orange" href="?page={{ page_obj.next_page_number }}">&#x2192</a>
        <a class="btn btn-outline-orange" href="?page={{ page_obj.paginator.num_pages }}">&#x21E5</a>
      {% endif %}
    </div>
  {% endif %}

{% endblock content %}